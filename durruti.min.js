!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.durruti=b()}(this,function(){"use strict";function a(){v===!0&&console.warn.apply(console,arguments)}function b(a,b,c){u.apply(this,arguments),w[this]=w[this]||[],w[this].push({type:a,fn:b,capture:c})}function c(a){if(w[a]){var b=w[a];b.forEach(function(b){a.removeEventListener(b.type,b.fn,b.capture)}),w[a]=null,delete w[a]}var d;for(d=0;d<a.children.length;d++)a.children[d].children.length&&c(a.children[d])}function d(a,b,c){for(var d=0;d<a.childNodes.length;d++)g(a.childNodes[d],b.childNodes[d],c)}function e(a,b){for(var c={},d=0;d<a.attributes.length;d++)c[a.attributes[d].name]=null;for(var e=0;e<b.attributes.length;e++)c[b.attributes[e].name]=b.attributes[e].value;return c}function f(a,b){var c=e(a,b);for(var d in c)c[d]?a.setAttribute(d,c[d]):a.removeAttribute(d);a._durruti=b._durruti}function g(a,b,c){if(a.isEqualNode(b))return[];var e=!1;return 1!==a.nodeType||1!==b.nodeType||a.tagName!==b.tagName||a.childNodes.length!==b.childNodes.length?e=!0:d(a,b,c),c.push({node:a,newNode:b,replace:e}),c}function h(a){a.replace?a.node.parentNode.replaceChild(a.newNode,a.node):(f(a.node,a.newNode),c(a.node))}function i(a,b){var c=g(a,b,[]);return c.forEach(h),c[0]&&c[0].node===a&&c[0].replace===!0?b:a}function j(a){var b;return b="function"==typeof a?new a:Object.create(a),b._durrutiId=String(C++),B[b._durrutiId]=b,b}function k(a){return a._durruti||B[a.getAttribute(z)]}function l(a,b){var c=[].slice.call(a.querySelectorAll(A));return b&&c.push(a),c.forEach(function(a){a._durruti=k(a),a.removeAttribute(z)}),c}function m(a){var b=k(a);b.unmount&&b.unmount(a),o(b)}function n(a){var b=k(a);b.mount&&b.mount(a)}function o(a){a?B[a._durrutiId]=null:(C=0,B={})}function p(){var a=arguments.length<=0||void 0===arguments[0]?"":arguments[0];a=a.trim();var b,c="div";if(0===a.indexOf("<tr")?c="tbody":0===a.indexOf("<td")&&(c="tr"),b=document.createElement(c),b.innerHTML=a,1!==b.children.length)throw new Error("Component template must have a single parent node.",a);return b.firstElementChild}function q(a,b){var c=a.indexOf("/>");-1===c&&(c=a.indexOf(">"));var d=" "+z+'="'+b._durrutiId+'"';return a.substr(0,c)+d+a.substr(c)}function r(a,b){var c;for(c=0;c<a.children.length;c++)a.children[c].children.length&&r(a.children[c],b),a.children[c]._durruti&&b.push(a.children[c]);return b}function s(a){var b=r(a,[]);return b.push(a),b}function t(){a("state.js is not included. Store data will not be shared between client and server.")}var u,v=!0,w={};"undefined"!=typeof window&&(window.Node.prototype.hasOwnProperty("addEventListener")?(u=window.Node.prototype.addEventListener,window.Node.prototype.addEventListener=b):window.EventTarget.prototype.hasOwnProperty("addEventListener")&&(u=window.EventTarget.prototype.addEventListener,window.EventTarget.prototype.addEventListener=b));var x=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},y=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),z="data-durruti-id",A="["+z+"]",B={},C=0,D=function(){function a(){x(this,a)}return y(a,[{key:"get",value:function(){t()}},{key:"set",value:function(){t()}}]),a}(),E=function(){function b(){x(this,b),this._state=new D}return y(b,[{key:"renderStatic",value:function(a){return o(),a}},{key:"render",value:function(b,c){var d=j(b);if("undefined"==typeof d.render)throw new Error("Components must have a render() method.");var e=d.render(),f=q(e,d);if("undefined"!=typeof window&&c){if(!document.body.contains(c))return void a("Node",c,"is no longer in the DOM. \nIt was probably removed by a parent component.");var g=[];if(k(c)){s(c).forEach(m);var h=p(f);l(h,!0),c=i(c,h),g=s(c)}else c.innerHTML.trim()!==f.trim()&&(c.innerHTML=f),g=l(c);g.forEach(n)}return f}}]),b}(),F=new E;return F});