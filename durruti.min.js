!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.durruti=b()}(this,function(){"use strict";function a(){u===!0&&console.warn.apply(console,arguments)}function b(){var a=[];for(var b in document)"on"===b.substr(0,2)&&a.push(b);return a}function c(a,b,c){t.apply(this,arguments),w[this]=w[this]||[],w[this].push({type:a,fn:b,capture:c})}function d(a,b){var c=arguments.length<=2||void 0===arguments[2]?[]:arguments[2];if(a._durruti&&c.push(a),b&&a.children)for(var e=0;e<a.children.length;e++)a.children[e].children.length&&d(a.children[e],!0,c);return c}function e(a,b,c){for(var d=0;d<a.childNodes.length;d++)h(a.childNodes[d],b.childNodes[d],c)}function f(a,b){for(var c={},d=0;d<a.attributes.length;d++)c[a.attributes[d].name]=null;for(var e=0;e<b.attributes.length;e++)c[b.attributes[e].name]=b.attributes[e].value;return c}function g(a,b){var c=f(a,b);for(var d in c)c[d]?a.setAttribute(d,c[d]):a.removeAttribute(d);a._durruti=b._durruti}function h(a,b,c){if(a.isEqualNode(b))return y(a,!0),Array.prototype.push.apply(c.components,d(a,!0)),c;var f=!1;return 1!==a.nodeType||1!==b.nodeType||a.tagName!==b.tagName||a.childNodes.length!==b.childNodes.length?(f=!0,Array.prototype.push.apply(c.components,d(b,!0))):(y(a),Array.prototype.push.apply(c.components,d(a)),e(a,b,c)),c.patches.push({node:a,newNode:b,replace:f}),c}function i(a){a.replace?a.node.parentNode.replaceChild(a.newNode,a.node):g(a.node,a.newNode)}function j(a,b){var c=h(a,b,{patches:[],components:[]});return c.patches.forEach(i),c.components}function k(a){var b;return b="function"==typeof a?new a:Object.create(a),b._durrutiId=String(E++),D[b._durrutiId]=b,b}function l(a){return a._durruti||D[a.getAttribute(B)]}function m(a,b){var c=[].slice.call(a.querySelectorAll(C));return b&&c.push(a),c.forEach(function(a){a._durruti=l(a),a.removeAttribute(B)}),c}function n(a){var b=l(a);b.unmount&&b.unmount(a),p(b)}function o(a){var b=l(a);b.mount&&b.mount(a)}function p(a){a?D[a._durrutiId]=null:(E=0,D={})}function q(){var a=arguments.length<=0||void 0===arguments[0]?"":arguments[0];a=a.trim();var b,c="div";if(0===a.indexOf("<tr")?c="tbody":0===a.indexOf("<td")&&(c="tr"),b=document.createElement(c),b.innerHTML=a,1!==b.children.length)throw new Error("Component template must have a single parent node.",a);return b.firstElementChild}function r(a,b){var c=a.indexOf("/>");-1===c&&(c=a.indexOf(">"));var d=" "+B+'="'+b._durrutiId+'"';return a.substr(0,c)+d+a.substr(c)}function s(){a("state.js is not included. Store data will not be shared between client and server.")}var t,u=!0,v=function(){},w={};if("undefined"!=typeof window){var x=b();window.Node.prototype.hasOwnProperty("addEventListener")?(t=window.Node.prototype.addEventListener,window.Node.prototype.addEventListener=c):window.EventTarget.prototype.hasOwnProperty("addEventListener")&&(t=window.EventTarget.prototype.addEventListener,window.EventTarget.prototype.addEventListener=c),v=function(a,b){var c=w[a];if(c&&(c.forEach(function(b){a.removeEventListener(b.type,b.fn,b.capture)}),x.forEach(function(b){a[b]=null}),w[a]=null),b&&a.children)for(var d=0;d<a.children.length;d++)a.children[d].children.length&&v(a.children[d],!0)}}var y=v,z=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},A=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),B="data-durruti-id",C="["+B+"]",D={},E=0,F=function(){function a(){z(this,a)}return A(a,[{key:"get",value:function(){s()}},{key:"set",value:function(){s()}}]),a}(),G=function(){function b(){z(this,b),this._state=new F}return A(b,[{key:"renderStatic",value:function(a){return p(),a}},{key:"render",value:function(b,c){var e=k(b);if("undefined"==typeof e.render)throw new Error("Components must have a render() method.");var f=e.render(),g=r(f,e);if("undefined"!=typeof window&&c){if(!document.body.contains(c))return void a("Node",c,"is no longer in the DOM. \nIt was probably removed by a parent component.");var h=[],i=q(g);l(c)?(d(c,!0).forEach(n),m(i,!0),h=j(c,i)):(c.firstElementChild&&c.firstElementChild.isEqualNode(i)||(c.innerHTML=g),h=m(c)),h.forEach(o)}return g}}]),b}(),H=new G;return H});