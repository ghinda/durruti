!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.durruti=b()}(this,function(){"use strict";function a(){o===!0&&console.warn.apply(console,arguments)}function b(a){var b;b="function"==typeof a?new a:a;var c=b._durruti||{};return c.id=String(u++),"function"!=typeof b.mount&&(b.mount=function(){}),"function"!=typeof b.unmount&&(b.unmount=function(){}),b._durruti=c,t[c.id]=b,b}function c(a){a||(u=0,t={}),t[a]=null}function d(){var a=arguments.length<=0||void 0===arguments[0]?"":arguments[0];a=a.trim();var b,c="div";if(0===a.indexOf("<tr")?c="tbody":0===a.indexOf("<td")&&(c="tr"),b=document.createElement(c),b.innerHTML=a,1!==b.children.length)throw new Error("Component template must have a single parent node.",a);return b.firstElementChild}function e(a,b){var c=a.indexOf(">"),d=" "+r+'="'+b+'"';return a.substr(0,c)+d+a.substr(c)}function f(){a("state.js is not included. Store data will not be shared between client and server.")}function g(a,b){var c;for(c=0;c<a.children.length;c++)a.children[c].children.length&&g(a.children[c],b),a.children[c]._durruti&&b.push(a.children[c]);return b}function h(a){var b=[];return g(a,b)}function i(a,b,c){var d=a.childNodes,e=b.childNodes;if(d.length===e.length){var f;for(f=0;f<e.length;f++)l(d[f],e[f],c)}else c.push({node:a,newNode:b,replace:!0})}function j(a,b){var c,d={};for(c=0;c<a.attributes.length;c++)d[a.attributes[c].name]=null;for(c=0;c<b.attributes.length;c++)d[b.attributes[c].name]=b.attributes[c].value;return d}function k(a,b){var c,d=j(a,b),e=Object.keys(d);for(c=0;c<e.length;c++)d[e[c]]?a.setAttribute(e[c],d[e[c]]):a.removeAttribute(e[c])}function l(a,b,c){var d=b.nodeType,e=a.nodeType,f=!1;1===e&&1===d?a.tagName!==b.tagName?f=!0:a.innerHTML!==b.innerHTML&&i(a,b,c):f=!0,c.push({node:a,newNode:b,replace:f})}function m(a){a.replace?a.node.parentNode.replaceChild(a.newNode,a.node):k(a.node,a.newNode),a.node._durruti=a.newNode._durruti}function n(a,b){var c=[];l(a,b,c);var d;for(d=0;d<c.length;d++)m(c[d])}var o=!0,p=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},q=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),r="data-durruti-id",s="["+r+"]",t={},u=0,v=function(){function a(){p(this,a)}return q(a,[{key:"get",value:function(){f()}},{key:"set",value:function(){f()}}]),a}(),w=function(){function f(){p(this,f),this._state=new v}return q(f,[{key:"renderStatic",value:function(a){return c(),a}},{key:"render",value:function(c,f){var g=b(c);if("undefined"==typeof g.render)throw new Error("Components must have a render() method.");var i,j,k=g.render(),l=e(k,g._durruti.id),m=[];if("undefined"!=typeof window&&f){if(!document.body.contains(f))return void a("Node",f,"is no longer in the DOM. \nIt was probably removed by a parent component.");var o=f.innerHTML;if(f._durruti){j=h(f),j.push(f),j.forEach(function(a){i=a._durruti,i.unmount(a)});var p=d(l);j=[].slice.call(p.querySelectorAll(s)),j.unshift(p),p._durruti=g,j.forEach(function(a){m.push(a),a.removeAttribute(r),a._durruti=g}),n(f,p)}else o.trim()!==l.trim()&&(f.innerHTML=l),j=[].slice.call(f.querySelectorAll(s)),j.forEach(function(a){m.push(a),a.removeAttribute(r),a._durruti=g}),f._durruti=g;m.forEach(function(a){a._durruti.mount(a)})}return l}}]),f}(),x=new w;return x});