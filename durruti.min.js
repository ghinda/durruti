!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.durruti=b()}(this,function(){"use strict";function a(){w===!0&&console.warn.apply(console,arguments)}function b(){var a=[];for(var b in document)"on"===b.substr(0,2)&&a.push(b);return a}function c(a,b,c){v.apply(this,arguments),x[this]=x[this]||[],x[this].push({type:a,fn:b,capture:c})}function d(a){var b=x[a];b&&(b.forEach(function(b){a.removeEventListener(b.type,b.fn,b.capture)}),y.forEach(function(b){a[b]=null}),x[a]=null);for(var c=0;c<a.children.length;c++)a.children[c].children.length&&d(a.children[c])}function e(a,b,c){for(var d=0;d<a.childNodes.length;d++)h(a.childNodes[d],b.childNodes[d],c)}function f(a,b){for(var c={},d=0;d<a.attributes.length;d++)c[a.attributes[d].name]=null;for(var e=0;e<b.attributes.length;e++)c[b.attributes[e].name]=b.attributes[e].value;return c}function g(a,b){var c=f(a,b);for(var d in c)c[d]?a.setAttribute(d,c[d]):a.removeAttribute(d);a._durruti=b._durruti}function h(a,b,c){if(a.isEqualNode(b))return[];var d=!1;return 1!==a.nodeType||1!==b.nodeType||a.tagName!==b.tagName||a.childNodes.length!==b.childNodes.length?d=!0:e(a,b,c),c.push({node:a,newNode:b,replace:d}),c}function i(a){a.replace?a.node.parentNode.replaceChild(a.newNode,a.node):(g(a.node,a.newNode),d(a.node))}function j(a,b){var c=h(a,b,[]);return c.forEach(i),c[0]&&c[0].node===a&&c[0].replace===!0?b:a}function k(a){var b;return b="function"==typeof a?new a:Object.create(a),b._durrutiId=String(E++),D[b._durrutiId]=b,b}function l(a){return a._durruti||D[a.getAttribute(B)]}function m(a,b){var c=[].slice.call(a.querySelectorAll(C));return b&&c.push(a),c.forEach(function(a){a._durruti=l(a),a.removeAttribute(B)}),c}function n(a){var b=l(a);b.unmount&&b.unmount(a),p(b)}function o(a){var b=l(a);b.mount&&b.mount(a)}function p(a){a?D[a._durrutiId]=null:(E=0,D={})}function q(){var a=arguments.length<=0||void 0===arguments[0]?"":arguments[0];a=a.trim();var b,c="div";if(0===a.indexOf("<tr")?c="tbody":0===a.indexOf("<td")&&(c="tr"),b=document.createElement(c),b.innerHTML=a,1!==b.children.length)throw new Error("Component template must have a single parent node.",a);return b.firstElementChild}function r(a,b){var c=a.indexOf("/>");-1===c&&(c=a.indexOf(">"));var d=" "+B+'="'+b._durrutiId+'"';return a.substr(0,c)+d+a.substr(c)}function s(a,b){var c;for(c=0;c<a.children.length;c++)a.children[c].children.length&&s(a.children[c],b),a.children[c]._durruti&&b.push(a.children[c]);return b}function t(a){var b=s(a,[]);return b.push(a),b}function u(){a("state.js is not included. Store data will not be shared between client and server.")}var v,w=!0,x={},y=b();"undefined"!=typeof window&&(window.Node.prototype.hasOwnProperty("addEventListener")?(v=window.Node.prototype.addEventListener,window.Node.prototype.addEventListener=c):window.EventTarget.prototype.hasOwnProperty("addEventListener")&&(v=window.EventTarget.prototype.addEventListener,window.EventTarget.prototype.addEventListener=c));var z=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},A=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),B="data-durruti-id",C="["+B+"]",D={},E=0,F=function(){function a(){z(this,a)}return A(a,[{key:"get",value:function(){u()}},{key:"set",value:function(){u()}}]),a}(),G=function(){function b(){z(this,b),this._state=new F}return A(b,[{key:"renderStatic",value:function(a){return p(),a}},{key:"render",value:function(b,c){var d=k(b);if("undefined"==typeof d.render)throw new Error("Components must have a render() method.");var e=d.render(),f=r(e,d);if("undefined"!=typeof window&&c){if(!document.body.contains(c))return void a("Node",c,"is no longer in the DOM. \nIt was probably removed by a parent component.");var g=[];if(l(c)){t(c).forEach(n);var h=q(f);m(h,!0),c=j(c,h),g=t(c)}else c.innerHTML.trim()!==f.trim()&&(c.innerHTML=f),g=m(c);g.forEach(o)}return f}}]),b}(),H=new G;return H});