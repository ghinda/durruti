!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.durruti=b()}(this,function(){"use strict";function a(){return"undefined"!=typeof window}function b(){v===!0&&console.warn.apply(console,arguments)}function c(){var a=[];for(var b in document)"on"===b.substr(0,2)&&a.push(b);return a}function d(a,b,c){t.apply(this,arguments),x[this]=x[this]||[],x[this].push({type:a,fn:b,capture:c})}function e(a,b){var c=arguments.length<=2||void 0===arguments[2]?[]:arguments[2];if(a._durruti&&c.push(a),b&&a.children)for(var d=0;d<a.children.length;d++)a.children[d].children.length&&e(a.children[d],!0,c);return c}function f(a,b,c){for(var d=0;d<a.childNodes.length;d++)i(a.childNodes[d],b.childNodes[d],c)}function g(a,b){for(var c={},d=0;d<a.attributes.length;d++)c[a.attributes[d].name]=null;for(var e=0;e<b.attributes.length;e++)c[b.attributes[e].name]=b.attributes[e].value;return c}function h(a,b){var c=g(a,b);for(var d in c)c[d]?a.setAttribute(d,c[d]):a.removeAttribute(d)}function i(a,b,c){if(a._durruti=b._durruti,a.isEqualNode(b))return z(a,!0),Array.prototype.push.apply(c.components,e(a,!0)),c;var d=!1;return 1!==a.nodeType||1!==b.nodeType||a.tagName!==b.tagName||a.childNodes.length!==b.childNodes.length?(d=!0,Array.prototype.push.apply(c.components,e(b,!0))):(z(a),Array.prototype.push.apply(c.components,e(a)),f(a,b,c)),c.patches.push({node:a,newNode:b,replace:d}),c}function j(a){a.replace?a.node.parentNode.replaceChild(a.newNode,a.node):h(a.node,a.newNode)}function k(a,b){var c=i(a,b,{patches:[],components:[]});return c.patches.forEach(j),c.components}function l(a){var b;return b="function"==typeof a?new a:Object.create(a),b._durrutiId=String(F++),E[b._durrutiId]=b,b}function m(a){return a._durruti||E[a.getAttribute(C)]}function n(a,b){var c=[].slice.call(a.querySelectorAll(D));return b&&c.push(a),c.forEach(function(a){a._durruti=m(a),a.removeAttribute(C)}),c}function o(a){var b=m(a);b.unmount&&b.unmount(a),q(b)}function p(a){var b=m(a);b.mount&&b.mount(a)}function q(a){a?E[a._durrutiId]=null:(F=0,E={})}function r(){var a=arguments.length<=0||void 0===arguments[0]?"":arguments[0];a=a.trim();var b,c="div";if(0===a.indexOf("<tr")?c="tbody":0===a.indexOf("<td")&&(c="tr"),b=document.createElement(c),b.innerHTML=a,1!==b.children.length)throw new Error("Component template must have a single parent node.",a);return b.firstElementChild}function s(a,b){var c=a.indexOf("/>");c===-1&&(c=a.indexOf(">"));var d=" "+C+'="'+b._durrutiId+'"';return a.substr(0,c)+d+a.substr(c)}var t,u=a(),v=!0,w=function(){},x={};if(u){var y=c();window.Node.prototype.hasOwnProperty("addEventListener")?(t=window.Node.prototype.addEventListener,window.Node.prototype.addEventListener=d):window.EventTarget.prototype.hasOwnProperty("addEventListener")&&(t=window.EventTarget.prototype.addEventListener,window.EventTarget.prototype.addEventListener=d),w=function(a,b){var c=x[a];if(c&&(c.forEach(function(b){a.removeEventListener(b.type,b.fn,b.capture)}),y.forEach(function(b){a[b]=null}),x[a]=null),b&&a.children)for(var d=0;d<a.children.length;d++)w(a.children[d],!0)}}var z=w,A=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},B=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),C="data-durruti-id",D="["+C+"]",E={},F=0,G=function(){function a(){A(this,a)}return B(a,[{key:"renderStatic",value:function(a){return q(),a}},{key:"render",value:function(a,c){var d=l(a);if("undefined"==typeof d.render)throw new Error("Components must have a render() method.");var f=d.render(),g=s(f,d);if(u&&c){if(!document.body.contains(c))return void b("Node",c,"is no longer in the DOM. \nIt was probably removed by a parent component.");var h=[],i=r(g);m(c)?(e(c,!0).forEach(o),n(i,!0),h=k(c,i)):(c.firstElementChild&&c.firstElementChild.isEqualNode(i)||(c.innerHTML=g),h=n(c)),h.forEach(p)}return g}}]),a}(),H=new G;return H});