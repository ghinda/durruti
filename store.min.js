!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):(a.durruti=a.durruti||{},a.durruti.Store=b())}(this,function(){"use strict";function a(a){return JSON.parse(JSON.stringify(a))}function b(){var b=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],c=arguments[1],d=a(b);return Object.keys(c).forEach(function(a){"undefined"!=typeof d[a]?d[a]=b[a]:d[a]=c[a]}),d}function c(a,c){c=c||{};var d=!1;if("undefined"!=typeof window&&(d=!0),this.options=b(c,{history:d}),this.events={change:[]},this.data=[],a){var e=i.get(a);e&&this.data.push(e);var f=this;this.on("change",function(){i.set(a,f.get())})}}var d=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f="DURRUTI",g={},h=function(){function a(){d(this,a)}return e(a,[{key:"get",value:function(a){return"undefined"!=typeof window?window[f]?window[f][a]:null:g[a]}},{key:"set",value:function(a,b){g[a]=b}},{key:"render",value:function(){return"\n      <script>\n      ;(function(){\n        window['"+f+"'] = JSON.parse('"+JSON.stringify(g)+"')\n      }());\n      </script>\n    "}}]),a}(),i=new h;return c.prototype.trigger=function(a){this.events[a]=this.events[a]||[];var b=this.events[a].slice();b.forEach(function(a){a()})},c.prototype.on=function(a,b){this.events[a]=this.events[a]||[],this.events[a].push(b)},c.prototype.off=function(a,b){this.events[a]=this.events[a]||[];var c=[].indexOf.call(this.events[a],b);-1!==c&&this.events[a].splice(c,1)},c.prototype.get=function(){var b=this.data[this.data.length-1];return b?a(b):null},c.prototype.list=function(){return a(this.data)},c.prototype.set=function(a){return this.options.history?this.data.push(a):this.data=[a],this.trigger("change"),this.get()},c});