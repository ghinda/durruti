!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):(a.durruti=a.durruti||{},a.durruti.Store=b())}(this,function(){"use strict";function a(){return"undefined"!=typeof window}function b(a){return JSON.parse(JSON.stringify(a))}function c(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],c=arguments[1],d=b(a);return Object.keys(c).forEach(function(b){"undefined"!=typeof d[b]?d[b]=a[b]:d[b]=c[b]}),d}function d(a,b){b=b||{};var d=!1;e&&(d=!0),this.options=c(b,{history:d}),this.events={change:[]},this.data=[]}var e=a();return d.prototype.trigger=function(a){this.events[a]=this.events[a]||[];var b=this.events[a].slice();b.forEach(function(a){a()})},d.prototype.on=function(a,b){this.events[a]=this.events[a]||[],this.events[a].push(b)},d.prototype.off=function(a,b){this.events[a]=this.events[a]||[];var c=[].indexOf.call(this.events[a],b);c!==-1&&this.events[a].splice(c,1)},d.prototype.get=function(){var a=this.data[this.data.length-1];return a?b(a):null},d.prototype.list=function(){return b(this.data)},d.prototype.set=function(a){return this.options.history?this.data.push(a):this.data=[a],this.trigger("change"),this.get()},d});